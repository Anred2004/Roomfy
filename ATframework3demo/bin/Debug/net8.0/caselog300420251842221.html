<!DOCTYPE html><div style="color: #000000">[30.04.2025 06:42:22.562][INFO] ---------------Запуск кейса 'Блокировка пользователя через Админ-панель'---------------</div>
<div style="color: #000000">[30.04.2025 06:42:22.568][INFO] OpenUri: http://roomfy.bx/</div>
<div style="color: #000000">[30.04.2025 06:42:29.137][INFO] Попытка выполнить php:</div>
<div style="color: #000000">require_once($_SERVER['DOCUMENT_ROOT'].'/bitrix/modules/main/include/prolog_before.php');</div>
<div style="color: #000000">function deleteUserById($userId) {</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000"></div>
<div style="color: #000000">$DB->Query("DELETE FROM up_roomfy_messages WHERE RECIEVER_ID = $userId");</div>
<div style="color: #000000">$DB->Query("DELETE FROM up_roomfy_posts WHERE USER_ID = $userId");</div>
<div style="color: #000000">$DB->Query("DELETE FROM b_user_group WHERE USER_ID = $userId");</div>
<div style="color: #000000">$user = new CUser;</div>
<div style="color: #000000">$result = $user->Delete($userId);</div>
<div style="color: #000000"></div>
<div style="color: #000000">if ($result) {</div>
<div style="color: #000000">echo "Пользователь с ID {$userId} успешно удален.\n";</div>
<div style="color: #000000">return true;</div>
<div style="color: #000000">} else {</div>
<div style="color: #000000">echo "Ошибка при удалении пользователя с ID {$userId}: " . $user->LAST_ERROR . "\n";</div>
<div style="color: #000000">return false;</div>
<div style="color: #000000">}</div>
<div style="color: #000000">}</div>
<div style="color: #000000">function deleteAllUsersExcept($excludedIds) {</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000"></div>
<div style="color: #000000">$excludedIdsList = implode(',', $excludedIds); // Преобразуем массив в строку для SQL-запроса</div>
<div style="color: #000000">$query = "</div>
<div style="color: #000000">SELECT ID</div>
<div style="color: #000000">FROM b_user</div>
<div style="color: #000000">WHERE ID NOT IN ($excludedIdsList)</div>
<div style="color: #000000">";</div>
<div style="color: #000000">$result = $DB->Query($query);</div>
<div style="color: #000000"></div>
<div style="color: #000000">while ($row = $result->Fetch()) {</div>
<div style="color: #000000">$userId = $row['ID'];</div>
<div style="color: #000000">deleteUserById($userId);</div>
<div style="color: #000000">}</div>
<div style="color: #000000">}</div>
<div style="color: #000000">$excludedUserIds = [1, 20]; // Список ID пользователей, которых не нужно удалять</div>
<div style="color: #000000">deleteAllUsersExcept($excludedUserIds);</div>
<div style="color: #000000">[30.04.2025 06:42:33.570][INFO] Результат выполнения php:</div>
<div style="color: #000000">[30.04.2025 06:42:33.585][INFO] Ожидание отображения элемента 'Поле Логин' локаторы: //input[@name = 'USER_LOGIN']</div>
<div style="color: #000000">[30.04.2025 06:42:33.645][INFO] Ожидание отображения элемента 'Поле Логин' локаторы: //input[@name = 'USER_LOGIN']</div>
<div style="color: #000000">[30.04.2025 06:42:33.690][INFO] Ввод текста '' в элемент: 'Поле Логин' локаторы: //input[@name = 'USER_LOGIN']</div>
<div style="color: #000000">[30.04.2025 06:42:34.789][INFO] Ожидание отображения элемента 'Поле Логин' локаторы: //input[@name = 'USER_LOGIN']</div>
<div style="color: #000000">[30.04.2025 06:42:34.825][INFO] Ввод текста 'admin' в элемент: 'Поле Логин' локаторы: //input[@name = 'USER_LOGIN']</div>
<div style="color: #000000">[30.04.2025 06:42:35.920][INFO] Ожидание отображения элемента 'Поле Пароль' локаторы: //input[@name = 'USER_PASSWORD']</div>
<div style="color: #000000">[30.04.2025 06:42:35.981][INFO] Ожидание отображения элемента 'Поле Пароль' локаторы: //input[@name = 'USER_PASSWORD']</div>
<div style="color: #000000">[30.04.2025 06:42:36.016][INFO] Ввод текста '' в элемент: 'Поле Пароль' локаторы: //input[@name = 'USER_PASSWORD']</div>
<div style="color: #000000">[30.04.2025 06:42:37.153][INFO] Ожидание отображения элемента 'Поле Пароль' локаторы: //input[@name = 'USER_PASSWORD']</div>
<div style="color: #000000">[30.04.2025 06:42:37.190][INFO] Ввод текста '1234root' в элемент: 'Поле Пароль' локаторы: //input[@name = 'USER_PASSWORD']</div>
<div style="color: #000000">[30.04.2025 06:42:38.289][INFO] Ожидание отображения элемента 'Кнопка Войти' локаторы: //button[@name = 'Login']</div>
<div style="color: #000000">[30.04.2025 06:42:38.360][INFO] Ожидание отображения элемента 'Кнопка Войти' локаторы: //button[@name = 'Login']</div>
<div style="color: #000000">[30.04.2025 06:42:38.402][INFO] Click: 'Кнопка Войти' локаторы: //button[@name = 'Login']</div>
<div style="color: #000000">[30.04.2025 06:42:42.834][INFO] Ожидание отображения элемента 'Кнопка Админ панель' локаторы: //a[@href= '/admin']</div>
<div style="color: #000000">[30.04.2025 06:42:43.632][INFO] Ожидание отображения элемента 'Кнопка Админ панель' локаторы: //a[@href= '/admin']</div>
<div style="color: #000000">[30.04.2025 06:42:43.705][INFO] Click: 'Кнопка Админ панель' локаторы: //a[@href= '/admin']</div>
<div style="color: #000000">[30.04.2025 06:42:50.093][INFO] Ожидание отображения элемента 'Раздел Активные пользователи в админ панеле' локаторы: //div[@class = 'title is-2 mt-4' and contains(text(), 'Активные пользователи ')]</div>
<div style="color: #000000">[30.04.2025 06:42:50.147][INFO] Ожидание отображения элемента 'Кнопка заблокировать' локаторы: //div[@class='columns is-vcentered']//*[contains(text(), 'login30042025184233')]//following::button[@class='button is-warning modal-button']</div>
