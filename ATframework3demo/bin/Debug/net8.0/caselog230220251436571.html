<!DOCTYPE html><div style="color: #000000">[23.02.2025 02:36:57.777][INFO] ---------------Запуск кейса 'Создание проекта + пост в ленту проекта'---------------</div>
<div style="color: #000000">[23.02.2025 02:36:57.783][INFO] OpenUri: http://192.168.1.42/</div>
<div style="color: #000000">[23.02.2025 02:37:27.856][INFO] Ожидание отображения элемента 'Поле для ввода логина' локаторы: //input[@id='login' or @name='USER_LOGIN']</div>
<div style="color: #000000">[23.02.2025 02:37:27.931][INFO] Ввод текста 'nastya.redkina.2004@mail.ru' в элемент: 'Поле для ввода логина' локаторы: //input[@id='login' or @name='USER_LOGIN']</div>
<div style="color: #000000">[23.02.2025 02:37:29.175][INFO] Ожидание отображения элемента 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[23.02.2025 02:37:29.234][INFO] Ожидание отображения элемента 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[23.02.2025 02:37:29.275][INFO] Ввод текста [логирование отключено] в элемент: 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[23.02.2025 02:37:30.457][INFO] Ожидание отображения элемента 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[23.02.2025 02:37:30.496][INFO] Ввод текста '' в элемент: 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[23.02.2025 02:37:54.797][INFO] Добавление пользователя ИванIXXXXVXIVXXXVIILII ЧёIIIXXXXVXIVXXXVIILII на портал скриптом</div>
<div style="color: #000000">[23.02.2025 02:37:54.799][INFO] Попытка выполнить php:</div>
<div style="color: #000000">$arFields["ADD_NAME"] = 'ИванIXXXXVXIVXXXVIILII';</div>
<div style="color: #000000">$arFields["ADD_LAST_NAME"] = 'ЧёIIIXXXXVXIVXXXVIILII';</div>
<div style="color: #000000">$arFields["ADD_EMAIL"] = 'bx1ivanchyoi-23022025023754@test.com';</div>
<div style="color: #000000">$arFields["DEPARTMENT_ID"] = '1';</div>
<div style="color: #000000"></div>
<div style="color: #000000">if ($arFields["DEPARTMENT_ID"] == 0)</div>
<div style="color: #000000">unset($arFields["DEPARTMENT_ID"]);</div>
<div style="color: #000000">else</div>
<div style="color: #000000">$arFields["DEPARTMENT_ID"] = [$arFields["DEPARTMENT_ID"]];</div>
<div style="color: #000000">$SITE_ID = "s1";</div>
<div style="color: #000000">$strError = "";</div>
<div style="color: #000000">$userID = 0;</div>
<div style="color: #000000">$userLogin = $arFields["ADD_EMAIL"];</div>
<div style="color: #000000">$userID = CIntranetInviteDialog::AddNewUser($SITE_ID, $arFields, $strError);</div>
<div style="color: #000000"></div>
<div style="color: #000000">if ($userID > 0) {</div>
<div style="color: #000000">echo "Пользователь ";</div>
<div style="color: #000000">echo $userLogin;</div>
<div style="color: #000000">echo " успешно добавлен на портал с ID ";</div>
<div style="color: #000000">if(is_array($userID))</div>
<div style="color: #000000">echo $userID[0];</div>
<div style="color: #000000">else</div>
<div style="color: #000000">echo $userID;</div>
<div style="color: #000000">echo "<br/>";</div>
<div style="color: #000000">}</div>
<div style="color: #000000"></div>
<div style="color: #000000">if ($strError != "")</div>
<div style="color: #000000">{</div>
<div style="color: #000000">if(is_array($strError))</div>
<div style="color: #000000">print_r($strError);</div>
<div style="color: #000000">else</div>
<div style="color: #000000">echo $strError;</div>
<div style="color: #000000">}</div>
<div style="color: #000000">[23.02.2025 02:38:56.481][INFO] Результат выполнения php:</div>
<div style="color: #000000">Пользователь bx1ivanchyoi-23022025023754@test.com успешно добавлен на портал с ID 39<br/></div>
<div style="color: #000000">[23.02.2025 02:38:56.680][INFO] Попытка выполнить php:</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000">$res = $DB->Query("select ID from b_user where EMAIL = 'bx1ivanchyoi-23022025023754@test.com'");</div>
<div style="color: #000000">$rows = [];</div>
<div style="color: #000000">while ($row = $res->Fetch())</div>
<div style="color: #000000">$rows[] = $row;</div>
<div style="color: #000000">echo json_encode($rows);</div>
<div style="color: #000000">[23.02.2025 02:39:05.218][INFO] Результат выполнения php:</div>
<div style="color: #000000">[{"ID":"39"}]</div>
<div style="color: #000000">[23.02.2025 02:39:08.363][INFO] Попытка выполнить php:</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000">$res = $DB->Query("SELECT GROUP_ID from b_user_group WHERE USER_ID = '39'");</div>
<div style="color: #000000">$rows = [];</div>
<div style="color: #000000">while ($row = $res->Fetch())</div>
<div style="color: #000000">$rows[] = $row;</div>
<div style="color: #000000">echo json_encode($rows);</div>
<div style="color: #000000">[23.02.2025 02:39:13.901][INFO] Результат выполнения php:</div>
<div style="color: #000000">[{"GROUP_ID":"3"},{"GROUP_ID":"4"}]</div>
<div style="color: #000000">[23.02.2025 02:39:13.906][INFO] Попытка выполнить php:</div>
<div style="color: #000000">$arFields["PASSWORD"] = 'H5L^U#R0,aA1';</div>
<div style="color: #000000">$groupIDS = '3,4';</div>
<div style="color: #000000">$userID = '39';</div>
<div style="color: #000000"></div>
<div style="color: #000000">$objUser = new CUser;</div>
<div style="color: #000000">$arGroupsIDs = explode(",", $groupIDS);</div>
<div style="color: #000000">$rsUser = CUser::GetByID($userID);</div>
<div style="color: #000000">$arUser = $rsUser->Fetch();</div>
<div style="color: #000000"></div>
<div style="color: #000000">foreach ($arFields as $key => $value)</div>
<div style="color: #000000">{</div>
<div style="color: #000000">if($key != "PASSWORD")</div>
<div style="color: #000000">$arUser[$key] = $value;</div>
<div style="color: #000000">}</div>
<div style="color: #000000"></div>
<div style="color: #000000">$fields = array(</div>
<div style="color: #000000">"NAME" => $arUser["NAME"],</div>
<div style="color: #000000">"LAST_NAME" => $arUser["LAST_NAME"],</div>
<div style="color: #000000">"EMAIL" => $arUser["EMAIL"],</div>
<div style="color: #000000">"LOGIN" => $arUser["LOGIN"],</div>
<div style="color: #000000">"LID" => $arUser["LID"],</div>
<div style="color: #000000">"ACTIVE" => $arUser["ACTIVE"],</div>
<div style="color: #000000">"GROUP_ID" => $arGroupsIDs,</div>
<div style="color: #000000">);</div>
<div style="color: #000000"></div>
<div style="color: #000000">if($arFields["PASSWORD"] != null)</div>
<div style="color: #000000">{</div>
<div style="color: #000000">$fields["PASSWORD"] = $arFields["PASSWORD"];</div>
<div style="color: #000000">$fields["CONFIRM_PASSWORD"] = $arFields["PASSWORD"];</div>
<div style="color: #000000">}</div>
<div style="color: #000000"></div>
<div style="color: #000000">$objUser->Update($userID, $fields);</div>
<div style="color: #000000">$res = $objUser->Login($arUser["EMAIL"], $newPassword);</div>
<div style="color: #000000">if (!is_array($res)) {</div>
<div style="color: #000000">echo "Успешная авторизация";</div>
<div style="color: #000000">} else {</div>
<div style="color: #000000">echo "Авторизация не удалась:\n";</div>
<div style="color: #000000">print_r($res);</div>
<div style="color: #000000">}</div>
<div style="color: #FF0000">[23.02.2025 02:39:37.179][ERROR] Кейс не пройден, причина:</div>
<div style="color: #FF0000">System.IO.IOException: The process cannot access the file 'C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\bin\Debug\net8.0\caselog230220251436571.html' because it is being used by another process.</div>
<div style="color: #FF0000">at Microsoft.Win32.SafeHandles.SafeFileHandle.CreateFile(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options)</div>
<div style="color: #FF0000">at Microsoft.Win32.SafeHandles.SafeFileHandle.Open(String fullPath, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize, Nullable`1 unixCreateMode)</div>
<div style="color: #FF0000">at System.IO.File.OpenHandle(String path, FileMode mode, FileAccess access, FileShare share, FileOptions options, Int64 preallocationSize)</div>
<div style="color: #FF0000">at System.IO.File.WriteToFile(String path, FileMode mode, String contents, Encoding encoding)</div>
<div style="color: #FF0000">at atFrameWork2.BaseFramework.LogTools.LogMessage.WriteHtml(String filePath, String text) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\BaseFramework\LogTools\LogMessage.cs:line 35</div>
<div style="color: #FF0000">at atFrameWork2.BaseFramework.LogTools.Log.Add(LogMessage message) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\BaseFramework\LogTools\Log.cs:line 32</div>
<div style="color: #FF0000">at atFrameWork2.BaseFramework.LogTools.Log.Info(String message) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\BaseFramework\LogTools\Log.cs:line 20</div>
<div style="color: #FF0000">at AquaTestFramework.CommonFramework.BitrixCPinteraction.PHPcommandLineExecutor.Execute(String phpCode) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\BaseFramework\BitrixCPinterraction\PHPcommandLineExecutor.cs:line 37</div>
<div style="color: #FF0000">at ATframework3demo.BaseFramework.BitrixCPinterraction.EmployeeTools.SetUserPassword(User user, Uri portalUri, User adminUser) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\BaseFramework\BitrixCPinterraction\EmployeeTools.cs:line 146</div>
<div style="color: #FF0000">at ATframework3demo.BaseFramework.BitrixCPinterraction.EmployeeTools.AddNewUserByPHP(User user, User portalAdmin, Uri portalUri, Int32 depID) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\BaseFramework\BitrixCPinterraction\EmployeeTools.cs:line 75</div>
<div style="color: #FF0000">at ATframework3demo.BaseFramework.BitrixCPinterraction.EmployeeTools.AddNewIntranetUser(User userToAdd, User portalAdmin, Uri portalUrl, Int32 departmentId) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\BaseFramework\BitrixCPinterraction\EmployeeTools.cs:line 18</div>
<div style="color: #FF0000">at atFrameWork2.BaseFramework.TestCase.CreatePortalTestUser(Boolean extranetUser) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\BaseFramework\TestCase.cs:line 123</div>
<div style="color: #FF0000">at ATframework3demo.TestCases.Case_Bitrix24_CreateProjectAndPost.CreateProjectAndSendPost(PortalHomePage homePage) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\TestCases\Case_Bitrix24_CreateProjectAndPost.cs:line 27</div>
<div style="color: #FF0000">at ATframework3demo.TestCases.Case_Bitrix24_CreateProjectAndPost.<GetCases>b__0_0(PortalHomePage homePage) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\TestCases\Case_Bitrix24_CreateProjectAndPost.cs:line 18</div>
<div style="color: #FF0000">at atFrameWork2.BaseFramework.TestCase.Execute(PortalInfo testPortal, Action uiRefresher) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\BaseFramework\TestCase.cs:line 61</div>
<div style="color: #000000">[23.02.2025 02:39:37.180][INFO] ---------------Кейс 'Создание проекта + пост в ленту проекта' завершён---------------</div>
