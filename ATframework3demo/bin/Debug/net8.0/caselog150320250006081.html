<!DOCTYPE html><div style="color: #000000">[15.03.2025 12:06:08.365][INFO] ---------------Запуск кейса 'Запуск робота Запланировать дело в CRM с проверкой его выполнения'---------------</div>
<div style="color: #000000">[15.03.2025 12:06:08.370][INFO] OpenUri: http://192.168.1.42/</div>
<div style="color: #000000">[15.03.2025 12:06:28.435][INFO] Ожидание отображения элемента 'Поле для ввода логина' локаторы: //input[@id='login' or @name='USER_LOGIN']</div>
<div style="color: #000000">[15.03.2025 12:06:28.505][INFO] Ввод текста 'nastya.redkina.2004@mail.ru' в элемент: 'Поле для ввода логина' локаторы: //input[@id='login' or @name='USER_LOGIN']</div>
<div style="color: #000000">[15.03.2025 12:06:29.640][INFO] Ожидание отображения элемента 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[15.03.2025 12:06:29.818][INFO] Ожидание отображения элемента 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[15.03.2025 12:06:29.855][INFO] Ввод текста [логирование отключено] в элемент: 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[15.03.2025 12:06:31.006][INFO] Ожидание отображения элемента 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[15.03.2025 12:06:31.038][INFO] Ввод текста '' в элемент: 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[15.03.2025 12:07:00.486][INFO] Попытка выполнить php:</div>
<div style="color: #000000">CModule::IncludeModule('crm');</div>
<div style="color: #000000">$arFields = [</div>
<div style="color: #000000">"TITLE" => "Сделка 15032025000700",</div>
<div style="color: #000000">"TYPE_ID" => "SALE",</div>
<div style="color: #000000">"STAGE_ID" => "NEW",</div>
<div style="color: #000000">"OPPORTUNITY" => 10000,</div>
<div style="color: #000000">"CURRENCY_ID" => "RUB",</div>
<div style="color: #000000">"ASSIGNED_BY_ID" => 1,</div>
<div style="color: #000000">"OPENED" => "Y",</div>
<div style="color: #000000">];</div>
<div style="color: #000000">$deal = new CCrmDeal(false);</div>
<div style="color: #000000">$dealId = $deal->Add($arFields);</div>
<div style="color: #000000">if ($dealId) {</div>
<div style="color: #000000">echo "Сделка успешно создана! ID сделки: " . $dealId;</div>
<div style="color: #000000">} else {</div>
<div style="color: #000000">global $APPLICATION;</div>
<div style="color: #000000">echo "Ошибка при создании сделки: " . $APPLICATION->GetException()->GetString();</div>
<div style="color: #000000">}</div>
<div style="color: #000000">[15.03.2025 12:08:14.570][INFO] Результат выполнения php:</div>
<div style="color: #000000">Сделка успешно создана! ID сделки: 39</div>
<div style="color: #000000">[15.03.2025 12:08:14.823][INFO] Добавление пользователя ИванXVIIIXXXXVVIIIXIV ЧёXVIIIXXXXVVIIIXIV на портал скриптом</div>
<div style="color: #000000">[15.03.2025 12:08:14.824][INFO] Попытка выполнить php:</div>
<div style="color: #000000">$arFields["ADD_NAME"] = 'ИванXVIIIXXXXVVIIIXIV';</div>
<div style="color: #000000">$arFields["ADD_LAST_NAME"] = 'ЧёXVIIIXXXXVVIIIXIV';</div>
<div style="color: #000000">$arFields["ADD_EMAIL"] = 'bx1ivanchyox-15032025120814@test.com';</div>
<div style="color: #000000">$arFields["DEPARTMENT_ID"] = '1';</div>
<div style="color: #000000"></div>
<div style="color: #000000">if ($arFields["DEPARTMENT_ID"] == 0)</div>
<div style="color: #000000">unset($arFields["DEPARTMENT_ID"]);</div>
<div style="color: #000000">else</div>
<div style="color: #000000">$arFields["DEPARTMENT_ID"] = [$arFields["DEPARTMENT_ID"]];</div>
<div style="color: #000000">$SITE_ID = "s1";</div>
<div style="color: #000000">$strError = "";</div>
<div style="color: #000000">$userID = 0;</div>
<div style="color: #000000">$userLogin = $arFields["ADD_EMAIL"];</div>
<div style="color: #000000">$userID = CIntranetInviteDialog::AddNewUser($SITE_ID, $arFields, $strError);</div>
<div style="color: #000000"></div>
<div style="color: #000000">if ($userID > 0) {</div>
<div style="color: #000000">echo "Пользователь ";</div>
<div style="color: #000000">echo $userLogin;</div>
<div style="color: #000000">echo " успешно добавлен на портал с ID ";</div>
<div style="color: #000000">if(is_array($userID))</div>
<div style="color: #000000">echo $userID[0];</div>
<div style="color: #000000">else</div>
<div style="color: #000000">echo $userID;</div>
<div style="color: #000000">echo "<br/>";</div>
<div style="color: #000000">}</div>
<div style="color: #000000"></div>
<div style="color: #000000">if ($strError != "")</div>
<div style="color: #000000">{</div>
<div style="color: #000000">if(is_array($strError))</div>
<div style="color: #000000">print_r($strError);</div>
<div style="color: #000000">else</div>
<div style="color: #000000">echo $strError;</div>
<div style="color: #000000">}</div>
<div style="color: #000000">[15.03.2025 12:08:49.652][INFO] Результат выполнения php:</div>
<div style="color: #000000">Пользователь bx1ivanchyox-15032025120814@test.com успешно добавлен на портал с ID 30<br/></div>
<div style="color: #000000">[15.03.2025 12:08:49.706][INFO] Попытка выполнить php:</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000">$res = $DB->Query("select ID from b_user where EMAIL = 'bx1ivanchyox-15032025120814@test.com'");</div>
<div style="color: #000000">$rows = [];</div>
<div style="color: #000000">while ($row = $res->Fetch())</div>
<div style="color: #000000">$rows[] = $row;</div>
<div style="color: #000000">echo json_encode($rows);</div>
<div style="color: #000000">[15.03.2025 12:08:53.988][INFO] Результат выполнения php:</div>
<div style="color: #000000">[{"ID":"30"}]</div>
<div style="color: #000000">[15.03.2025 12:08:54.491][INFO] Попытка выполнить php:</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000">$res = $DB->Query("SELECT GROUP_ID from b_user_group WHERE USER_ID = '30'");</div>
<div style="color: #000000">$rows = [];</div>
<div style="color: #000000">while ($row = $res->Fetch())</div>
<div style="color: #000000">$rows[] = $row;</div>
<div style="color: #000000">echo json_encode($rows);</div>
<div style="color: #000000">[15.03.2025 12:08:59.029][INFO] Результат выполнения php:</div>
<div style="color: #000000">[{"GROUP_ID":"3"},{"GROUP_ID":"4"}]</div>
<div style="color: #000000">[15.03.2025 12:08:59.040][INFO] Попытка выполнить php:</div>
<div style="color: #000000">$arFields["PASSWORD"] = 'Ns|s8pPz,aA1';</div>
<div style="color: #000000">$groupIDS = '3,4';</div>
<div style="color: #000000">$userID = '30';</div>
<div style="color: #000000"></div>
<div style="color: #000000">$objUser = new CUser;</div>
<div style="color: #000000">$arGroupsIDs = explode(",", $groupIDS);</div>
<div style="color: #000000">$rsUser = CUser::GetByID($userID);</div>
<div style="color: #000000">$arUser = $rsUser->Fetch();</div>
<div style="color: #000000"></div>
<div style="color: #000000">foreach ($arFields as $key => $value)</div>
<div style="color: #000000">{</div>
<div style="color: #000000">if($key != "PASSWORD")</div>
<div style="color: #000000">$arUser[$key] = $value;</div>
<div style="color: #000000">}</div>
<div style="color: #000000"></div>
<div style="color: #000000">$fields = array(</div>
<div style="color: #000000">"NAME" => $arUser["NAME"],</div>
<div style="color: #000000">"LAST_NAME" => $arUser["LAST_NAME"],</div>
<div style="color: #000000">"EMAIL" => $arUser["EMAIL"],</div>
<div style="color: #000000">"LOGIN" => $arUser["LOGIN"],</div>
<div style="color: #000000">"LID" => $arUser["LID"],</div>
<div style="color: #000000">"ACTIVE" => $arUser["ACTIVE"],</div>
<div style="color: #000000">"GROUP_ID" => $arGroupsIDs,</div>
<div style="color: #000000">);</div>
<div style="color: #000000"></div>
<div style="color: #000000">if($arFields["PASSWORD"] != null)</div>
<div style="color: #000000">{</div>
<div style="color: #000000">$fields["PASSWORD"] = $arFields["PASSWORD"];</div>
<div style="color: #000000">$fields["CONFIRM_PASSWORD"] = $arFields["PASSWORD"];</div>
<div style="color: #000000">}</div>
<div style="color: #000000"></div>
<div style="color: #000000">$objUser->Update($userID, $fields);</div>
<div style="color: #000000">$res = $objUser->Login($arUser["EMAIL"], $newPassword);</div>
<div style="color: #000000">if (!is_array($res)) {</div>
<div style="color: #000000">echo "Успешная авторизация";</div>
<div style="color: #000000">} else {</div>
<div style="color: #000000">echo "Авторизация не удалась:\n";</div>
<div style="color: #000000">print_r($res);</div>
<div style="color: #000000">}</div>
<div style="color: #000000">[15.03.2025 12:09:15.337][INFO] Результат выполнения php:</div>
<div style="color: #000000">Успешная авторизация</div>
<div style="color: #000000">[15.03.2025 12:09:15.338][INFO] Попытка выполнить php:</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000">$res = $DB->Query("UPDATE b_user SET CONFIRM_CODE = '' WHERE LOGIN = 'bx1ivanchyox-15032025120814@test.com'");</div>
<div style="color: #000000">$rows = [];</div>
<div style="color: #000000">while ($row = $res->Fetch())</div>
<div style="color: #000000">$rows[] = $row;</div>
<div style="color: #000000">echo json_encode($rows);</div>
<div style="color: #000000">[15.03.2025 12:09:25.332][INFO] Результат выполнения php:</div>
<div style="color: #000000">[]</div>
<div style="color: #000000">[15.03.2025 12:09:25.351][INFO] Попытка выполнить php:</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000">$res = $DB->Query("SELECT ID from b_group WHERE STRING_ID = 'EMPLOYEES_s1'");</div>
<div style="color: #000000">$rows = [];</div>
<div style="color: #000000">while ($row = $res->Fetch())</div>
<div style="color: #000000">$rows[] = $row;</div>
<div style="color: #000000">echo json_encode($rows);</div>
<div style="color: #000000">[15.03.2025 12:09:32.605][INFO] Результат выполнения php:</div>
<div style="color: #000000">[{"ID":"12"}]</div>
<div style="color: #000000">[15.03.2025 12:09:32.641][INFO] Попытка выполнить php:</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000">$res = $DB->Query("select ID from b_user where EMAIL = 'bx1ivanchyox-15032025120814@test.com'");</div>
<div style="color: #000000">$rows = [];</div>
<div style="color: #000000">while ($row = $res->Fetch())</div>
<div style="color: #000000">$rows[] = $row;</div>
<div style="color: #000000">echo json_encode($rows);</div>
<div style="color: #000000">[15.03.2025 12:09:34.974][INFO] Результат выполнения php:</div>
<div style="color: #000000">[{"ID":"30"}]</div>
<div style="color: #000000">[15.03.2025 12:09:34.976][INFO] Попытка выполнить php:</div>
<div style="color: #000000">CUser::AppendUserGroup(30, 12)</div>
<div style="color: #000000">[15.03.2025 12:09:36.387][INFO] Результат выполнения php:</div>
<div style="color: #000000">[15.03.2025 12:09:36.388][INFO] Пользователь ИванXVIIIXXXXVVIIIXIV ЧёXVIIIXXXXVVIIIXIV успешно добавлен на портал</div>
<div style="color: #000000">[15.03.2025 12:09:36.391][INFO] Попытка выполнить php:</div>
<div style="color: #000000">CModule::IncludeModule('main');</div>
<div style="color: #000000">$userName = "ИванXVIIIXXXXVVIIIXIV";</div>
<div style="color: #000000">$userLastName = "ЧёXVIIIXXXXVVIIIXIV";</div>
<div style="color: #000000">$groupIds = [10];</div>
<div style="color: #000000">$filter = [</div>
<div style="color: #000000">"NAME" => $userName,</div>
<div style="color: #000000">"LAST_NAME" => $userLastName,</div>
<div style="color: #000000">];</div>
<div style="color: #000000"></div>
<div style="color: #000000">$user = new CUser;</div>
<div style="color: #000000">$rsUser = CUser::GetList(($by = "id"), ($order = "asc"), $filter);</div>
<div style="color: #000000">$arUser = $rsUser->Fetch();</div>
<div style="color: #000000">$userId = $arUser['ID'];</div>
<div style="color: #000000">$currentGroups = $user->GetUserGroup($userId);</div>
<div style="color: #000000">$newGroups = array_unique(array_merge($currentGroups, $groupIds));</div>
<div style="color: #000000">$result = $user->SetUserGroup($userId, $newGroups);</div>
<div style="color: #000000">[15.03.2025 12:09:40.625][INFO] Результат выполнения php:</div>
<div style="color: #000000">[15.03.2025 12:09:40.644][INFO] Ожидание отображения элемента 'Пункт левого меню CRM' локаторы: //li[@id='bx_left_menu_menu_crm_favorite']</div>
<div style="color: #000000">[15.03.2025 12:09:40.731][INFO] Получен размер '{Width=240, Height=686}'. Элемент: 'Область с пунктами левого меню' локаторы: //div[@id='menu-items-block']</div>
<div style="color: #000000">[15.03.2025 12:09:40.737][INFO] Ожидание отображения элемента 'Пункт левого меню CRM' локаторы: //li[@id='bx_left_menu_menu_crm_favorite']</div>
<div style="color: #000000">[15.03.2025 12:09:40.767][INFO] Ожидание отображения элемента 'Пункт левого меню CRM' локаторы: //li[@id='bx_left_menu_menu_crm_favorite']</div>
<div style="color: #000000">[15.03.2025 12:09:40.790][INFO] Click: 'Пункт левого меню CRM' локаторы: //li[@id='bx_left_menu_menu_crm_favorite']</div>
<div style="color: #FF0000">[15.03.2025 12:10:41.617][ERROR] Кейс не пройден, причина:</div>
<div style="color: #FF0000">OpenQA.Selenium.WebDriverException: The HTTP request to the remote WebDriver server for URL http://localhost:50461/session/5d80e741c927849e5a2668d60d0003f1/element/f.75217FE9747B2358BAFEF25ACCA7C98D.d.4776792A59434F9B107E947E3AF4819F.e.154/click timed out after 60 seconds.</div>
<div style="color: #FF0000">---> System.Threading.Tasks.TaskCanceledException: The request was canceled due to the configured HttpClient.Timeout of 60 seconds elapsing.</div>
<div style="color: #FF0000">---> System.TimeoutException: The operation was canceled.</div>
<div style="color: #FF0000">---> System.Threading.Tasks.TaskCanceledException: The operation was canceled.</div>
<div style="color: #FF0000">---> System.IO.IOException: Unable to read data from the transport connection: Операция ввода/вывода была прервана из-за завершения потока команд или по запросу приложения..</div>
<div style="color: #FF0000">---> System.Net.Sockets.SocketException (995): Операция ввода/вывода была прервана из-за завершения потока команд или по запросу приложения.</div>
<div style="color: #FF0000">--- End of inner exception stack trace ---</div>
<div style="color: #FF0000">at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)</div>
<div style="color: #FF0000">at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource<System.Int32>.GetResult(Int16 token)</div>
<div style="color: #FF0000">at System.Net.Http.HttpConnection.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)</div>
<div style="color: #FF0000">--- End of inner exception stack trace ---</div>
<div style="color: #FF0000">at System.Net.Http.HttpConnection.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)</div>
<div style="color: #FF0000">at System.Net.Http.HttpConnectionPool.SendWithVersionDetectionAndRetryAsync(HttpRequestMessage request, Boolean async, Boolean doRequestAuth, CancellationToken cancellationToken)</div>
<div style="color: #FF0000">at System.Net.Http.DiagnosticsHandler.SendAsyncCore(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)</div>
<div style="color: #FF0000">at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, Boolean async, CancellationToken cancellationToken)</div>
<div style="color: #FF0000">at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)</div>
<div style="color: #FF0000">--- End of inner exception stack trace ---</div>
<div style="color: #FF0000">--- End of inner exception stack trace ---</div>
<div style="color: #FF0000">at System.Net.Http.HttpClient.HandleFailure(Exception e, Boolean telemetryStarted, HttpResponseMessage response, CancellationTokenSource cts, CancellationToken cancellationToken, CancellationTokenSource pendingRequestsCts)</div>
<div style="color: #FF0000">at System.Net.Http.HttpClient.<SendAsync>g__Core|83_0(HttpRequestMessage request, HttpCompletionOption completionOption, CancellationTokenSource cts, Boolean disposeCts, CancellationTokenSource pendingRequestsCts, CancellationToken originalCancellationToken)</div>
<div style="color: #FF0000">at OpenQA.Selenium.Remote.HttpCommandExecutor.MakeHttpRequest(HttpRequestInfo requestInfo)</div>
<div style="color: #FF0000">at OpenQA.Selenium.Remote.HttpCommandExecutor.ExecuteAsync(Command commandToExecute)</div>
<div style="color: #FF0000">--- End of inner exception stack trace ---</div>
<div style="color: #FF0000">at OpenQA.Selenium.Remote.HttpCommandExecutor.ExecuteAsync(Command commandToExecute)</div>
<div style="color: #FF0000">at OpenQA.Selenium.Remote.DriverServiceCommandExecutor.ExecuteAsync(Command commandToExecute)</div>
<div style="color: #FF0000">at OpenQA.Selenium.WebDriver.ExecuteAsync(String driverCommandToExecute, Dictionary`2 parameters)</div>
<div style="color: #FF0000">at OpenQA.Selenium.WebDriver.InternalExecute(String driverCommandToExecute, Dictionary`2 parameters)</div>
<div style="color: #FF0000">at OpenQA.Selenium.WebElement.Execute(String commandToExecute, Dictionary`2 parameters)</div>
<div style="color: #FF0000">at OpenQA.Selenium.WebElement.Click()</div>
<div style="color: #FF0000">at atFrameWork2.SeleniumFramework.BaseItem.<>c.<Click>b__19_0(IWebElement button, IWebDriver drv) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\SeleniumFramework\BaseItem.cs:line 48</div>
<div style="color: #FF0000">at atFrameWork2.SeleniumFramework.BaseItem.Execute(Action`2 seleniumCode, IWebDriver driver, Boolean throwAtDebug) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\SeleniumFramework\BaseItem.cs:line 130</div>
<div style="color: #FF0000">at atFrameWork2.SeleniumFramework.BaseItem.Click(IWebDriver driver) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\SeleniumFramework\BaseItem.cs:line 46</div>
<div style="color: #FF0000">at atFrameWork2.PageObjects.PortalLeftMenu.ClickMenuItem(WebItem menuItem) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\PageObjects\PortalLeftMenu.cs:line 45</div>
<div style="color: #FF0000">at atFrameWork2.PageObjects.PortalLeftMenu.OpenCRM() in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\PageObjects\PortalLeftMenu.cs:line 89</div>
<div style="color: #FF0000">at ATframework3demo.TestCases.Case_Bitrix24_Robot.LaunchRobot(PortalHomePage homePage) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\TestCases\Case_Bitrix24_Robot.cs:line 31</div>
<div style="color: #FF0000">at ATframework3demo.TestCases.Case_Bitrix24_Robot.<GetCases>b__0_0(PortalHomePage homePage) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\TestCases\Case_Bitrix24_Robot.cs:line 18</div>
<div style="color: #FF0000">at atFrameWork2.BaseFramework.TestCase.Execute(PortalInfo testPortal, Action uiRefresher) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\BaseFramework\TestCase.cs:line 61</div>
<div style="color: #000000">[15.03.2025 12:10:41.618][INFO] ---------------Кейс 'Запуск робота Запланировать дело в CRM с проверкой его выполнения' завершён---------------</div>
