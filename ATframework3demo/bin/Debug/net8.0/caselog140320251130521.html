<!DOCTYPE html><div style="color: #000000">[14.03.2025 11:30:52.818][INFO] ---------------Запуск кейса 'Запуск робота Запланировать дело в CRM с проверкой его выполнения'---------------</div>
<div style="color: #000000">[14.03.2025 11:30:52.824][INFO] OpenUri: http://192.168.1.42/</div>
<div style="color: #000000">[14.03.2025 11:30:59.071][INFO] Ожидание отображения элемента 'Поле для ввода логина' локаторы: //input[@id='login' or @name='USER_LOGIN']</div>
<div style="color: #000000">[14.03.2025 11:30:59.221][INFO] Ввод текста 'nastya.redkina.2004@mail.ru' в элемент: 'Поле для ввода логина' локаторы: //input[@id='login' or @name='USER_LOGIN']</div>
<div style="color: #000000">[14.03.2025 11:31:00.384][INFO] Ожидание отображения элемента 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[14.03.2025 11:31:00.442][INFO] Ожидание отображения элемента 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[14.03.2025 11:31:00.481][INFO] Ввод текста [логирование отключено] в элемент: 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[14.03.2025 11:31:01.656][INFO] Ожидание отображения элемента 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[14.03.2025 11:31:01.719][INFO] Ввод текста '' в элемент: 'Поле для ввода пароля' локаторы: //input[@id='password' or @name='USER_PASSWORD']</div>
<div style="color: #000000">[14.03.2025 11:31:26.885][INFO] Добавление пользователя ИванIIIXXXXVXIXXXIXXVI ЧёIVIIIXXXXVXIXXXIXXVI на портал скриптом</div>
<div style="color: #000000">[14.03.2025 11:31:26.888][INFO] Попытка выполнить php:</div>
<div style="color: #000000">$arFields["ADD_NAME"] = 'ИванIIIXXXXVXIXXXIXXVI';</div>
<div style="color: #000000">$arFields["ADD_LAST_NAME"] = 'ЧёIVIIIXXXXVXIXXXIXXVI';</div>
<div style="color: #000000">$arFields["ADD_EMAIL"] = 'bx1ivanchyoi-14032025113126@test.com';</div>
<div style="color: #000000">$arFields["DEPARTMENT_ID"] = '1';</div>
<div style="color: #000000"></div>
<div style="color: #000000">if ($arFields["DEPARTMENT_ID"] == 0)</div>
<div style="color: #000000">unset($arFields["DEPARTMENT_ID"]);</div>
<div style="color: #000000">else</div>
<div style="color: #000000">$arFields["DEPARTMENT_ID"] = [$arFields["DEPARTMENT_ID"]];</div>
<div style="color: #000000">$SITE_ID = "s1";</div>
<div style="color: #000000">$strError = "";</div>
<div style="color: #000000">$userID = 0;</div>
<div style="color: #000000">$userLogin = $arFields["ADD_EMAIL"];</div>
<div style="color: #000000">$userID = CIntranetInviteDialog::AddNewUser($SITE_ID, $arFields, $strError);</div>
<div style="color: #000000"></div>
<div style="color: #000000">if ($userID > 0) {</div>
<div style="color: #000000">echo "Пользователь ";</div>
<div style="color: #000000">echo $userLogin;</div>
<div style="color: #000000">echo " успешно добавлен на портал с ID ";</div>
<div style="color: #000000">if(is_array($userID))</div>
<div style="color: #000000">echo $userID[0];</div>
<div style="color: #000000">else</div>
<div style="color: #000000">echo $userID;</div>
<div style="color: #000000">echo "<br/>";</div>
<div style="color: #000000">}</div>
<div style="color: #000000"></div>
<div style="color: #000000">if ($strError != "")</div>
<div style="color: #000000">{</div>
<div style="color: #000000">if(is_array($strError))</div>
<div style="color: #000000">print_r($strError);</div>
<div style="color: #000000">else</div>
<div style="color: #000000">echo $strError;</div>
<div style="color: #000000">}</div>
<div style="color: #000000">[14.03.2025 11:32:38.346][INFO] Результат выполнения php:</div>
<div style="color: #000000">Пользователь bx1ivanchyoi-14032025113126@test.com успешно добавлен на портал с ID 23<br/></div>
<div style="color: #000000">[14.03.2025 11:32:38.378][INFO] Попытка выполнить php:</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000">$res = $DB->Query("select ID from b_user where EMAIL = 'bx1ivanchyoi-14032025113126@test.com'");</div>
<div style="color: #000000">$rows = [];</div>
<div style="color: #000000">while ($row = $res->Fetch())</div>
<div style="color: #000000">$rows[] = $row;</div>
<div style="color: #000000">echo json_encode($rows);</div>
<div style="color: #000000">[14.03.2025 11:32:50.894][INFO] Результат выполнения php:</div>
<div style="color: #000000">[{"ID":"23"}]</div>
<div style="color: #000000">[14.03.2025 11:32:51.276][INFO] Попытка выполнить php:</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000">$res = $DB->Query("SELECT GROUP_ID from b_user_group WHERE USER_ID = '23'");</div>
<div style="color: #000000">$rows = [];</div>
<div style="color: #000000">while ($row = $res->Fetch())</div>
<div style="color: #000000">$rows[] = $row;</div>
<div style="color: #000000">echo json_encode($rows);</div>
<div style="color: #000000">[14.03.2025 11:32:58.559][INFO] Результат выполнения php:</div>
<div style="color: #000000">[{"GROUP_ID":"3"},{"GROUP_ID":"4"}]</div>
<div style="color: #000000">[14.03.2025 11:32:58.577][INFO] Попытка выполнить php:</div>
<div style="color: #000000">$arFields["PASSWORD"] = 'EEOQV,R+,aA1';</div>
<div style="color: #000000">$groupIDS = '3,4';</div>
<div style="color: #000000">$userID = '23';</div>
<div style="color: #000000"></div>
<div style="color: #000000">$objUser = new CUser;</div>
<div style="color: #000000">$arGroupsIDs = explode(",", $groupIDS);</div>
<div style="color: #000000">$rsUser = CUser::GetByID($userID);</div>
<div style="color: #000000">$arUser = $rsUser->Fetch();</div>
<div style="color: #000000"></div>
<div style="color: #000000">foreach ($arFields as $key => $value)</div>
<div style="color: #000000">{</div>
<div style="color: #000000">if($key != "PASSWORD")</div>
<div style="color: #000000">$arUser[$key] = $value;</div>
<div style="color: #000000">}</div>
<div style="color: #000000"></div>
<div style="color: #000000">$fields = array(</div>
<div style="color: #000000">"NAME" => $arUser["NAME"],</div>
<div style="color: #000000">"LAST_NAME" => $arUser["LAST_NAME"],</div>
<div style="color: #000000">"EMAIL" => $arUser["EMAIL"],</div>
<div style="color: #000000">"LOGIN" => $arUser["LOGIN"],</div>
<div style="color: #000000">"LID" => $arUser["LID"],</div>
<div style="color: #000000">"ACTIVE" => $arUser["ACTIVE"],</div>
<div style="color: #000000">"GROUP_ID" => $arGroupsIDs,</div>
<div style="color: #000000">);</div>
<div style="color: #000000"></div>
<div style="color: #000000">if($arFields["PASSWORD"] != null)</div>
<div style="color: #000000">{</div>
<div style="color: #000000">$fields["PASSWORD"] = $arFields["PASSWORD"];</div>
<div style="color: #000000">$fields["CONFIRM_PASSWORD"] = $arFields["PASSWORD"];</div>
<div style="color: #000000">}</div>
<div style="color: #000000"></div>
<div style="color: #000000">$objUser->Update($userID, $fields);</div>
<div style="color: #000000">$res = $objUser->Login($arUser["EMAIL"], $newPassword);</div>
<div style="color: #000000">if (!is_array($res)) {</div>
<div style="color: #000000">echo "Успешная авторизация";</div>
<div style="color: #000000">} else {</div>
<div style="color: #000000">echo "Авторизация не удалась:\n";</div>
<div style="color: #000000">print_r($res);</div>
<div style="color: #000000">}</div>
<div style="color: #000000">[14.03.2025 11:33:16.599][INFO] Результат выполнения php:</div>
<div style="color: #000000">Успешная авторизация</div>
<div style="color: #000000">[14.03.2025 11:33:16.601][INFO] Попытка выполнить php:</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000">$res = $DB->Query("UPDATE b_user SET CONFIRM_CODE = '' WHERE LOGIN = 'bx1ivanchyoi-14032025113126@test.com'");</div>
<div style="color: #000000">$rows = [];</div>
<div style="color: #000000">while ($row = $res->Fetch())</div>
<div style="color: #000000">$rows[] = $row;</div>
<div style="color: #000000">echo json_encode($rows);</div>
<div style="color: #000000">[14.03.2025 11:33:21.571][INFO] Результат выполнения php:</div>
<div style="color: #000000">[]</div>
<div style="color: #000000">[14.03.2025 11:33:21.574][INFO] Попытка выполнить php:</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000">$res = $DB->Query("SELECT ID from b_group WHERE STRING_ID = 'EMPLOYEES_s1'");</div>
<div style="color: #000000">$rows = [];</div>
<div style="color: #000000">while ($row = $res->Fetch())</div>
<div style="color: #000000">$rows[] = $row;</div>
<div style="color: #000000">echo json_encode($rows);</div>
<div style="color: #000000">[14.03.2025 11:33:24.393][INFO] Результат выполнения php:</div>
<div style="color: #000000">[{"ID":"12"}]</div>
<div style="color: #000000">[14.03.2025 11:33:24.400][INFO] Попытка выполнить php:</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000">$res = $DB->Query("select ID from b_user where EMAIL = 'bx1ivanchyoi-14032025113126@test.com'");</div>
<div style="color: #000000">$rows = [];</div>
<div style="color: #000000">while ($row = $res->Fetch())</div>
<div style="color: #000000">$rows[] = $row;</div>
<div style="color: #000000">echo json_encode($rows);</div>
<div style="color: #000000">[14.03.2025 11:33:29.118][INFO] Результат выполнения php:</div>
<div style="color: #000000">[{"ID":"23"}]</div>
<div style="color: #000000">[14.03.2025 11:33:29.119][INFO] Попытка выполнить php:</div>
<div style="color: #000000">CUser::AppendUserGroup(23, 12)</div>
<div style="color: #000000">[14.03.2025 11:33:31.846][INFO] Результат выполнения php:</div>
<div style="color: #000000">[14.03.2025 11:33:31.846][INFO] Пользователь ИванIIIXXXXVXIXXXIXXVI ЧёIVIIIXXXXVXIXXXIXXVI успешно добавлен на портал</div>
<div style="color: #000000">[14.03.2025 11:33:31.861][INFO] Ожидание отображения элемента 'Пункт левого меню CRM' локаторы: //li[@id='bx_left_menu_menu_crm_favorite']</div>
<div style="color: #000000">[14.03.2025 11:33:31.965][INFO] Получен размер '{Width=240, Height=686}'. Элемент: 'Область с пунктами левого меню' локаторы: //div[@id='menu-items-block']</div>
<div style="color: #000000">[14.03.2025 11:33:31.970][INFO] Ожидание отображения элемента 'Пункт левого меню CRM' локаторы: //li[@id='bx_left_menu_menu_crm_favorite']</div>
<div style="color: #000000">[14.03.2025 11:33:32.014][INFO] Ожидание отображения элемента 'Пункт левого меню CRM' локаторы: //li[@id='bx_left_menu_menu_crm_favorite']</div>
<div style="color: #000000">[14.03.2025 11:33:32.051][INFO] Click: 'Пункт левого меню CRM' локаторы: //li[@id='bx_left_menu_menu_crm_favorite']</div>
<div style="color: #000000">[14.03.2025 11:34:19.165][INFO] Ожидание отображения элемента 'Раздел Канбан активный' локаторы: //div[@class = 'ui-nav-panel__item --active' and contains(text(), 'Канбан')]</div>
<div style="color: #000000">[14.03.2025 11:34:41.377][INFO] Достигнут таймаут ожидания</div>
<div style="color: #000000">[14.03.2025 11:34:41.841][INFO] Ожидание отображения элемента 'Раздел Канбан' локаторы: //div[@class = 'ui-nav-panel__item' and contains(text(), 'Канбан')]</div>
<div style="color: #000000">[14.03.2025 11:34:42.659][INFO] Ожидание отображения элемента 'Раздел Канбан' локаторы: //div[@class = 'ui-nav-panel__item' and contains(text(), 'Канбан')]</div>
<div style="color: #000000">[14.03.2025 11:34:43.366][INFO] Click: 'Раздел Канбан' локаторы: //div[@class = 'ui-nav-panel__item' and contains(text(), 'Канбан')]</div>
<div style="color: #000000">[14.03.2025 11:34:45.851][INFO] SwitchToFrame: 'Фрейм страницы создания робота' локаторы: //iframe[contains(@src, '/crm/deal/automation/')]</div>
<div style="color: #FF0000">[14.03.2025 11:35:25.729][ERROR] Кейс не пройден, причина:</div>
<div style="color: #FF0000">OpenQA.Selenium.NoSuchElementException: no such element: Unable to locate element: {"method":"xpath","selector":"//iframe[contains(@src, '/crm/deal/automation/')]"}</div>
<div style="color: #FF0000">(Session info: chrome=133.0.6943.127); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception</div>
<div style="color: #FF0000">at OpenQA.Selenium.WebDriver.UnpackAndThrowOnError(Response errorResponse, String commandToExecute)</div>
<div style="color: #FF0000">at OpenQA.Selenium.WebDriver.ExecuteAsync(String driverCommandToExecute, Dictionary`2 parameters)</div>
<div style="color: #FF0000">at OpenQA.Selenium.WebDriver.Execute(String driverCommandToExecute, Dictionary`2 parameters)</div>
<div style="color: #FF0000">at OpenQA.Selenium.WebDriver.FindElement(String mechanism, String value)</div>
<div style="color: #FF0000">at OpenQA.Selenium.By.<.ctor>b__11_0(ISearchContext context)</div>
<div style="color: #FF0000">at OpenQA.Selenium.By.FindElement(ISearchContext context)</div>
<div style="color: #FF0000">at OpenQA.Selenium.WebDriver.FindElement(By by)</div>
<div style="color: #FF0000">at atFrameWork2.SeleniumFramework.BaseItem.Execute(Action`2 seleniumCode, IWebDriver driver, Boolean throwAtDebug) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\SeleniumFramework\BaseItem.cs:line 129</div>
<div style="color: #FF0000">at atFrameWork2.SeleniumFramework.WebItem.SwitchToFrame(IWebDriver driver) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\SeleniumFramework\WebItem.cs:line 46</div>
<div style="color: #FF0000">at ATframework3demo.PageObjects.RobotsBasePage.SetDealStage() in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\PageObjects\RobotsBasePage.cs:line 43</div>
<div style="color: #FF0000">at ATframework3demo.TestCases.Case_Bitrix24_Robot.LaunchRobot(PortalHomePage homePage) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\TestCases\Case_Bitrix24_Robot.cs:line 32</div>
<div style="color: #FF0000">at ATframework3demo.TestCases.Case_Bitrix24_Robot.<GetCases>b__0_0(PortalHomePage homePage) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\TestCases\Case_Bitrix24_Robot.cs:line 16</div>
<div style="color: #FF0000">at atFrameWork2.BaseFramework.TestCase.Execute(PortalInfo testPortal, Action uiRefresher) in C:\Users\Сергей\Desktop\Bitrix\Bitrix24\ATlearning\ATframework3demo\BaseFramework\TestCase.cs:line 61</div>
<div style="color: #000000">[14.03.2025 11:35:25.731][INFO] ---------------Кейс 'Запуск робота Запланировать дело в CRM с проверкой его выполнения' завершён---------------</div>
