<!DOCTYPE html><div style="color: #000000">[30.04.2025 06:40:17.093][INFO] ---------------Запуск кейса 'Блокировка пользователя через Админ-панель'---------------</div>
<div style="color: #000000">[30.04.2025 06:40:17.097][INFO] OpenUri: http://roomfy.bx/</div>
<div style="color: #000000">[30.04.2025 06:40:42.533][INFO] Попытка выполнить php:</div>
<div style="color: #000000">require_once($_SERVER['DOCUMENT_ROOT'].'/bitrix/modules/main/include/prolog_before.php');</div>
<div style="color: #000000">function deleteUserById($userId) {</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000"></div>
<div style="color: #000000">$DB->Query("DELETE FROM up_roomfy_messages WHERE RECIEVER_ID = $userId");</div>
<div style="color: #000000">$DB->Query("DELETE FROM up_roomfy_posts WHERE USER_ID = $userId");</div>
<div style="color: #000000">$DB->Query("DELETE FROM b_user_group WHERE USER_ID = $userId");</div>
<div style="color: #000000">$user = new CUser;</div>
<div style="color: #000000">$result = $user->Delete($userId);</div>
<div style="color: #000000"></div>
<div style="color: #000000">if ($result) {</div>
<div style="color: #000000">echo "Пользователь с ID {$userId} успешно удален.\n";</div>
<div style="color: #000000">return true;</div>
<div style="color: #000000">} else {</div>
<div style="color: #000000">echo "Ошибка при удалении пользователя с ID {$userId}: " . $user->LAST_ERROR . "\n";</div>
<div style="color: #000000">return false;</div>
<div style="color: #000000">}</div>
<div style="color: #000000">}</div>
<div style="color: #000000">function deleteAllUsersExcept($excludedIds) {</div>
<div style="color: #000000">global $DB;</div>
<div style="color: #000000"></div>
<div style="color: #000000">$excludedIdsList = implode(',', $excludedIds); // Преобразуем массив в строку для SQL-запроса</div>
<div style="color: #000000">$query = "</div>
<div style="color: #000000">SELECT ID</div>
<div style="color: #000000">FROM b_user</div>
<div style="color: #000000">WHERE ID NOT IN ($excludedIdsList)</div>
<div style="color: #000000">";</div>
<div style="color: #000000">$result = $DB->Query($query);</div>
<div style="color: #000000"></div>
<div style="color: #000000">while ($row = $result->Fetch()) {</div>
<div style="color: #000000">$userId = $row['ID'];</div>
<div style="color: #000000">deleteUserById($userId);</div>
<div style="color: #000000">}</div>
<div style="color: #000000">}</div>
<div style="color: #000000">$excludedUserIds = [1, 20]; // Список ID пользователей, которых не нужно удалять</div>
<div style="color: #000000">deleteAllUsersExcept($excludedUserIds);</div>
<div style="color: #000000">[30.04.2025 06:40:50.971][INFO] Результат выполнения php:</div>
<div style="color: #000000">[30.04.2025 06:40:50.990][INFO] Ожидание отображения элемента 'Поле Логин' локаторы: //input[@name = 'USER_LOGIN']</div>
<div style="color: #000000">[30.04.2025 06:40:51.139][INFO] Ожидание отображения элемента 'Поле Логин' локаторы: //input[@name = 'USER_LOGIN']</div>
<div style="color: #000000">[30.04.2025 06:40:51.186][INFO] Ввод текста '' в элемент: 'Поле Логин' локаторы: //input[@name = 'USER_LOGIN']</div>
<div style="color: #000000">[30.04.2025 06:40:52.427][INFO] Ожидание отображения элемента 'Поле Логин' локаторы: //input[@name = 'USER_LOGIN']</div>
<div style="color: #000000">[30.04.2025 06:40:52.469][INFO] Ввод текста 'admin' в элемент: 'Поле Логин' локаторы: //input[@name = 'USER_LOGIN']</div>
<div style="color: #000000">[30.04.2025 06:40:53.587][INFO] Ожидание отображения элемента 'Поле Пароль' локаторы: //input[@name = 'USER_PASSWORD']</div>
<div style="color: #000000">[30.04.2025 06:40:53.657][INFO] Ожидание отображения элемента 'Поле Пароль' локаторы: //input[@name = 'USER_PASSWORD']</div>
<div style="color: #000000">[30.04.2025 06:40:53.693][INFO] Ввод текста '' в элемент: 'Поле Пароль' локаторы: //input[@name = 'USER_PASSWORD']</div>
<div style="color: #000000">[30.04.2025 06:40:54.807][INFO] Ожидание отображения элемента 'Поле Пароль' локаторы: //input[@name = 'USER_PASSWORD']</div>
<div style="color: #000000">[30.04.2025 06:40:54.840][INFO] Ввод текста '1234root' в элемент: 'Поле Пароль' локаторы: //input[@name = 'USER_PASSWORD']</div>
<div style="color: #000000">[30.04.2025 06:40:55.941][INFO] Ожидание отображения элемента 'Кнопка Войти' локаторы: //button[@name = 'Login']</div>
<div style="color: #000000">[30.04.2025 06:40:55.987][INFO] Ожидание отображения элемента 'Кнопка Войти' локаторы: //button[@name = 'Login']</div>
<div style="color: #000000">[30.04.2025 06:40:56.022][INFO] Click: 'Кнопка Войти' локаторы: //button[@name = 'Login']</div>
<div style="color: #000000">[30.04.2025 06:40:59.036][INFO] Ожидание отображения элемента 'Кнопка Админ панель' локаторы: //a[@href= '/admin']</div>
